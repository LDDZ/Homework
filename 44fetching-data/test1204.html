<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <div class="test1"></div>
    <div class="test2">
        <img src="" alt="" data-name="image">
    </div>
    <script>
        // var textDiv = document.querySelector('.test1');
        // console.log(textDiv);

        // var url = 'verse4.txt';
        // // 1.0创建请求对象
        // var ajax = new XMLHttpRequest();

        // // 2.0设置请求对象
        // // 2.1用open() 方法来指定从网络请求资源的 HTTP request method , 以及URL。
        // ajax.open('get', url);
        // // 2.2设置响应类型 （返回什么类型的数据）
        // ajax.responseType = 'text';
        // // 2.3注册请求成功事件，事件发生后请求的响应数据response可用
        // ajax.onreadystatechange = function () {
        //     if (ajax.readyState == 4 && ajax.status == 200)

        //         textDiv.textContent = ajax.response;//ajax.response为响应数据
        // };

        // // 3.0发送请求
        // ajax.send();

        var textDiv2 = document.querySelector('.test2');
        console.log(textDiv2);

        var url2 = 'can-store-xhr/products.json';
        var arr;
        // 1.0创建请求对象
        var ajax2 = new XMLHttpRequest();

        // 2.0设置请求对象
        // 2.1用open() 方法来指定从网络请求资源的 HTTP request method , 以及URL。
        ajax2.open('get', url2);
        // 2.2设置响应类型 （返回什么类型的数据）
        ajax2.responseType = 'json';
        // 2.3注册请求成功事件，事件发生后请求的响应数据response可用
        ajax2.onreadystatechange = function () {
            if (ajax2.readyState == 4 && ajax2.status == 200) {
                console.log(ajax2.response);
                arr = ajax2.response;
                console.log(arr[3]);
                let element = arr[3];
                displayElement(element);
            }
        };

        // 3.0发送请求
        ajax2.send();


        function displayElement(element) {
            let imgNode = document.querySelector('[data-name="image"]');
            console.log(element.image);
            imgNode.src = "can-store-xhr/images/"+element.image;
            console.log(imgNode);
        }
    </script>
</body>

</html>